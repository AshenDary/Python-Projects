lrt1_single_journey_fares = [
    [ 0, 15, 15, 20, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30, 35, 35],
    [15,  0, 15, 15, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30, 35, 35],
    [15, 15,  0, 15, 15, 20, 20, 20, 25, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30, 35, 35],
    [20, 15, 15,  0, 15, 15, 20, 20, 25, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30, 35, 35],
    [20, 20, 15, 15,  0, 15, 15, 20, 25, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30, 35, 35],
    [20, 20, 20, 15, 15,  0, 15, 15, 20, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30, 35, 35],
    [20, 20, 20, 20, 15, 15,  0, 15, 20, 20, 25, 25, 25, 25, 30, 30, 30, 30, 30, 35, 35],
    [20, 20, 20, 20, 20, 15, 15,  0, 15, 15, 20, 25, 25, 25, 30, 30, 30, 30, 30, 35, 35],
    [25, 25, 25, 25, 25, 20, 20, 15,  0, 15, 15, 20, 25, 25, 30, 30, 30, 30, 30, 35, 35],
    [25, 25, 25, 25, 25, 25, 20, 15, 15,  0, 15, 15, 20, 25, 30, 30, 30, 30, 30, 35, 35],
    [25, 25, 25, 25, 25, 25, 25, 20, 15, 15,  0, 15, 15, 20, 25, 30, 30, 30, 30, 35, 35],
    [25, 25, 25, 25, 25, 25, 25, 25, 20, 15, 15,  0, 15, 15, 20, 25, 30, 30, 30, 35, 35],
    [25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 15, 15,  0, 15, 15, 20, 25, 30, 30, 35, 35],
    [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 20, 15, 15,  0, 15, 15, 20, 25, 30, 35, 35],
    [30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 25, 20, 15, 15,  0, 15, 20, 25, 25, 30, 35],
    [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 25, 20, 15, 15,  0, 15, 20, 25, 30, 35],
    [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 25, 20, 15, 15,  0, 15, 20, 30, 35],
    [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 25, 20, 15, 15,  0, 15, 20, 35],
    [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 25, 20, 15, 15,  0, 20, 35],
    [35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 30, 30, 30, 30, 25, 20,  0, 20],
    [35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 20,  0]
]

lrt1_stored_value_fares = [
    [13, 14, 15, 16, 17, 18, 19, 20, 22, 23, 23, 24, 24, 25, 26, 27, 28, 29, 30, 33, 35],
    [14, 13, 15, 15, 17, 18, 19, 20, 21, 22, 23, 23, 24, 24, 25, 26, 27, 28, 29, 30, 34],
    [15, 15, 13, 14, 15, 16, 17, 18, 20, 21, 21, 22, 22, 23, 23, 24, 25, 26, 27, 28, 31],
    [16, 15, 14, 13, 15, 15, 16, 17, 19, 19, 20, 20, 21, 21, 22, 23, 24, 25, 26, 27, 30],
    [17, 17, 15, 15, 13, 14, 15, 16, 17, 18, 19, 19, 19, 20, 21, 21, 22, 23, 24, 25, 29],
    [18, 18, 16, 15, 14, 13, 14, 15, 16, 17, 17, 18, 19, 19, 19, 20, 21, 22, 23, 24, 28],
    [19, 19, 17, 16, 15, 14, 13, 14, 15, 16, 17, 17, 18, 18, 18, 19, 20, 21, 22, 23, 27],
    [20, 20, 18, 17, 16, 15, 14, 13, 14, 15, 16, 16, 17, 17, 17, 18, 19, 20, 21, 22, 26],
    [22, 21, 20, 19, 17, 16, 15, 14, 13, 14, 15, 15, 16, 16, 16, 17, 18, 19, 20, 21, 25],
    [23, 22, 21, 19, 18, 17, 16, 15, 14, 13, 14, 14, 15, 15, 15, 16, 17, 18, 19, 20, 24],
    [23, 23, 21, 20, 19, 17, 17, 16, 15, 14, 13, 14, 14, 15, 15, 15, 16, 17, 18, 19, 23],
    [24, 23, 22, 20, 19, 18, 17, 16, 15, 14, 14, 13, 14, 14, 14, 15, 16, 16, 17, 18, 23],
    [24, 24, 22, 21, 19, 19, 17, 16, 15, 14, 14, 14, 13, 14, 14, 14, 15, 16, 17, 18, 22],
    [25, 24, 23, 21, 20, 19, 18, 17, 16, 15, 15, 14, 14, 13, 14, 14, 15, 16, 17, 18, 22],
    [26, 25, 23, 22, 21, 19, 19, 18, 17, 15, 15, 14, 14, 14, 13, 14, 15, 15, 16, 17, 21],
    [27, 26, 24, 23, 21, 20, 19, 18, 17, 16, 15, 15, 14, 14, 14, 13, 14, 15, 16, 17, 20],
    [28, 27, 25, 24, 22, 21, 20, 19, 18, 17, 16, 15, 15, 15, 15, 14, 13, 14, 15, 16, 19],
    [29, 28, 26, 25, 23, 22, 21, 20, 19, 18, 17, 16, 16, 16, 15, 15, 14, 13, 14, 15, 18],
    [30, 29, 27, 26, 24, 23, 22, 21, 20, 19, 18, 17, 17, 17, 16, 16, 15, 14, 13, 14, 18],
    [33, 30, 28, 27, 25, 24, 23, 22, 21, 20, 19, 18, 18, 18, 17, 17, 16, 15, 14, 13, 13],
    [35, 34, 31, 30, 29, 28, 27, 26, 25, 24, 23, 23, 22, 22, 21, 20, 19, 18, 18, 13, 13]
]

lrt2_single_journey_fares = [
    [13, 15, 16, 18, 19, 21, 22, 23, 25, 26, 28, 31, 33],
    [15, 13, 15, 17, 18, 19, 21, 22, 24, 25, 27, 29, 32],
    [16, 15, 13, 15, 16, 18, 19, 20, 22, 23, 26, 28, 30],
    [18, 17, 15, 13, 15, 16, 17, 19, 20, 22, 24, 26, 29],
    [19, 18, 16, 15, 13, 14, 16, 17, 19, 20, 22, 24, 27],
    [21, 19, 18, 16, 14, 13, 15, 16, 18, 19, 21, 23, 26],
    [22, 21, 19, 17, 16, 15, 13, 15, 16, 18, 20, 22, 25],
    [23, 22, 20, 19, 17, 16, 15, 13, 15, 16, 19, 21, 23],
    [25, 24, 22, 20, 19, 18, 16, 15, 13, 14, 17, 19, 22],
    [26, 25, 23, 22, 20, 19, 18, 16, 14, 13, 16, 18, 21],
    [28, 27, 26, 24, 22, 21, 20, 19, 17, 16, 13, 15, 18],
    [31, 29, 28, 26, 24, 23, 22, 21, 19, 18, 15, 13, 16],
    [33, 32, 30, 29, 27, 26, 25, 23, 22, 21, 18, 16, 13]
]

lrt2_stored_value_fares = [
    [0, 15, 20, 20, 20, 25, 25, 25, 25, 30, 30, 35, 35],
    [15, 0, 15, 20, 20, 20, 25, 25, 25, 25, 30, 30, 35],
    [20, 15, 0, 15, 20, 20, 20, 20, 25, 25, 30, 30, 30],
    [20, 20, 15, 0, 15, 20, 20, 20, 20, 25, 25, 30, 30],
    [20, 20, 20, 15, 0, 15, 20, 20, 20, 20, 25, 25, 30],
    [25, 20, 20, 20, 15, 0, 15, 20, 20, 20, 25, 25, 30],
    [25, 25, 20, 20, 20, 15, 0, 15, 20, 20, 20, 25, 25],
    [25, 25, 20, 20, 20, 20, 15, 0, 15, 20, 20, 25, 25],
    [25, 25, 25, 20, 20, 20, 20, 15, 0, 15, 20, 20, 25],
    [30, 25, 25, 25, 20, 20, 20, 20, 15, 0, 20, 20, 25],
    [30, 30, 30, 25, 25, 25, 20, 20, 20, 20, 0, 15, 20],
    [35, 30, 30, 30, 25, 25, 25, 25, 20, 20, 15, 0, 20],
    [35, 35, 30, 30, 30, 30, 25, 25, 25, 25, 20, 20, 0]
]

mrt3_fares = [
    [0, 13, 13, 16, 16, 20, 20, 20, 24, 24, 24, 28, 28],
    [13, 0, 13, 13, 13, 16, 20, 20, 20, 24, 24, 24, 28],
    [13, 13, 0, 13, 13, 16, 16, 20, 20, 20, 24, 24, 28],
    [16, 13, 13, 0, 13, 16, 16, 20, 20, 20, 24, 24, 24],
    [16, 16, 13, 13, 0, 13, 16, 16, 20, 20, 20, 24, 24],
    [20, 16, 16, 16, 13, 0, 13, 13, 16, 16, 20, 24, 24],
    [20, 20, 16, 16, 16, 13, 0, 13, 13, 16, 16, 20, 24],
    [20, 20, 20, 16, 16, 13, 13, 0, 13, 13, 16, 16, 20],
    [24, 20, 20, 20, 16, 16, 13, 13, 0, 13, 13, 16, 16],
    [24, 24, 20, 20, 20, 16, 16, 13, 13, 0, 13, 13, 16],
    [24, 24, 24, 24, 20, 20, 16, 16, 13, 13, 0, 13, 13],
    [28, 24, 24, 24, 24, 20, 20, 16, 16, 13, 13, 0, 13],
    [28, 28, 28, 24, 24, 24, 24, 20, 16, 16, 13, 13, 0]
]

lrt1_distances = [
    0.59, 1.01, 0.73, 1.06,
    0.83, 0.79, 0.75, 1.21,
    0.73, 0.69, 0.65, 0.62,
    0.67, 0.93, 0.66, 0.95,
    1.09, 2.25, 1.87
]

lrt2_distances = [
    1.11, 1.22, 1.27, 1.04,
    1.21, 1.25, 1.18, 1.25,
    1.10, 1.35, 1.20
]

mrt3_distances = [
    1.7, 1.3, 1.8, 1.5, 1.6,
    1.3, 1.4, 1.7, 2.2, 1.0,
    1.2, 1.4
]

lrt1_stations = [
    "Roosevelt", "Balintawak", "Monumento", "5th Avenue", "R. Papa",
    "Abad Santos", "Blumentritt", "Tayuman", "Bambang", "Doroteo Jose",
    "Carriedo", "Central Terminal", "United Nations", "Pedro Gil",
    "Quirino", "Vito Cruz", "Gil Puyat", "Libertad", "EDSA", "Baclaran"
]

lrt2_stations = [
    "Recto", "Legarda", "Pureza", "V-Mapa", "J-Ruiz","Gilmore", "Betty-Go-Belmonte",
    "Cubao", "Anonas", "Katipunan", "Santolan", "Marikina", "Antipolo"
]

mrt3_stations = [
    "North Ave", "Quezon Ave", "GMA Kamuning", "Cubao Araneta",
    "Santolan Annapolis", "Ortigas", "Shaw Blvd", "Boni Ave",
    "Guadalupe", "Buendia", "Ayala", "Magallanes", "Taft Ave"
]

def calculate_discounted_fare(fare, discount_type):
    discount = 0
    if discount_type == 'student':
        discount = 0.20
    elif discount_type == 'pwd' or discount_type == 'senior':
        discount = 0.30
    return fare * (1 - discount)

def calculate_fare(start_station, end_station, ticket_type, discount_type=None, line='LRT1'):
    if line == 'LRT1' and start_station in lrt1_stations and end_station in lrt1_stations:
        start_index = lrt1_stations.index(start_station)
        end_index = lrt1_stations.index(end_station)

        if ticket_type == 'single journey':
            fare = lrt1_single_journey_fares[start_index][end_index]
        elif ticket_type == 'beep card':
            fare = lrt1_stored_value_fares[start_index][end_index]
        else:
            return None

    elif line == 'LRT2' and start_station in lrt2_stations and end_station in lrt2_stations:
        start_index = lrt2_stations.index(start_station)
        end_index = lrt2_stations.index(end_station)

        if ticket_type == 'single journey':
            fare = lrt2_single_journey_fares[start_index][end_index]
        elif ticket_type == 'beep card':
            fare = lrt2_stored_value_fares[start_index][end_index]
        else:
            return None

    elif line == 'MRT3' and start_station in mrt3_stations and end_station in mrt3_stations:
        start_index = mrt3_stations.index(start_station)
        end_index = mrt3_stations.index(end_station)

        if ticket_type == 'single journey':
            fare = mrt3_fares[start_index][end_index]
        elif ticket_type == 'beep card':
            fare = mrt3_fares[start_index][end_index]
        else:
            return None

    else:
        return "Invalid station choice, please select valid stations for the chosen line."

    if start_index == end_index:
        return 0.0

    if discount_type:
        fare = calculate_discounted_fare(fare, discount_type)

    return fare

def prompt_for_choice(prompt, choices):
    normalized_choices = {choice.lower(): choice for choice in choices}
    while True:
        user_input = input(prompt).strip().lower()
        if user_input in normalized_choices:
            return normalized_choices[user_input]
        else:
            print(f"\nInvalid choice. Please select one of: {'\n'.join(choices)}")

def print_intro():
    print("=" * 80)
    print(" " * 25 + "Welcome to the Train Stations!")
    print("=" * 80)

def lrt1_print_intro():
    print("=" * 80)
    print(" " * 29 + "Welcome to the LRT 1!")

def lrt2_print_intro():
    print("=" * 80)
    print(" " * 29 + "Welcome to the LRT 2!")

def mrt3_print_intro():
    print("=" * 80)
    print(" " * 29 + "Welcome to the MRT 3!")

def lrt1_print_stations():
    print("=" * 80)
    print(" " * 35 + "Stations")
    print("=" * 80)

    num_columns = 3
    stations_per_column = (len(lrt1_stations) + num_columns - 1) // num_columns

    for row in range(stations_per_column):
        line = ""
        for col in range(num_columns):
            index = row + col * stations_per_column
            if index < len(lrt1_stations):
                line += f"| {index + 1:2d}. {lrt1_stations[index]:<20} "
            else:
                line += " " * 27
        print(line + "|")

    print("=" * 80)

def lrt2_print_stations():
    print("=" * 80)
    print(" " * 35 + "Stations")
    print("=" * 80)

    num_columns = 3
    stations_per_column = (len(lrt2_stations) + num_columns - 1) // num_columns

    for row in range(stations_per_column):
        line = ""
        for col in range(num_columns):
            index = row + col * stations_per_column
            if index < len(lrt2_stations):
                line += f"| {index + 1:2d}. {lrt2_stations[index]:<20} "
            else:
                line += " " * 27
        print(line + "|")

    print("=" * 80)

def mrt3_print_stations():
    print("=" * 80)
    print(" " * 35 + "Stations")
    print("=" * 80)

    num_columns = 3
    stations_per_column = (len(mrt3_stations) + num_columns - 1) // num_columns

    for row in range(stations_per_column):
        line = ""
        for col in range(num_columns):
            index = row + col * stations_per_column
            if index < len(mrt3_stations):
                line += f"| {index + 1:2d}. {mrt3_stations[index]:<20} "
            else:
                line += " " * 27
        print(line + "|")

    print("=" * 80)

def print_fare(fare, start_station, end_station):
    print("\n" + "=" * 80)
    print(" " * 15 + f"The fare from {start_station} to {end_station} is: ₱{fare:.2f}")
    print("=" * 80 + "\n")

def normalize_case(choices):
    return {choice.lower(): choice for choice in choices}

def main():
    print_intro()
    normalized_lrt1_stations = normalize_case(lrt1_stations)
    normalized_lrt2_stations = normalize_case(lrt2_stations)
    normalized_mrt3_stations = normalize_case(mrt3_stations)
    previous_end_station = None

    total_distance = 0
    total_fare = 0
    total_stations_passed = 0

    train_line = prompt_for_choice("\nWhich train line? (LRT1/LRT2/MRT3): ", ['LRT1', 'LRT2', 'MRT3'])

    if train_line == 'LRT1':
        lrt1_print_intro()
        lrt1_print_stations()
        normalized_stations = normalized_lrt1_stations
        stations = lrt1_stations

    elif train_line == 'LRT2':
        lrt2_print_intro()
        lrt2_print_stations()
        normalized_stations = normalized_lrt2_stations
        stations = lrt2_stations

    elif train_line == 'MRT3':
        mrt3_print_intro()
        mrt3_print_stations()
        normalized_stations = normalized_mrt3_stations
        stations = mrt3_stations

    while True:

        print(" " * 15 + "Type the name of the station to pick a station")
        print("=" * 80)

        if previous_end_station:
            start_station = previous_end_station
        else:
            start_station = prompt_for_choice("\nEnter start station: ", normalized_stations.keys())
            start_station = normalized_stations[start_station]

        print("=" * 80)
        end_station = prompt_for_choice("\nEnter end station: ", normalized_stations.keys())
        end_station = normalized_stations[end_station]
        print("\n" + "=" * 80)

        while start_station == end_station:
            print("\nStart and end stations cannot be the same. Please choose again.\n")
            end_station = prompt_for_choice("Enter end station: ", normalized_stations.keys())
            end_station = normalized_stations[end_station]
            print("\n" + "=" * 80)

        ticket_type = prompt_for_choice("\nEnter ticket type (single journey/beep card): ", ['single journey', 'beep card'])

        discount_type = prompt_for_choice("\nEnter discount type (student/pwd/senior/none): ", ['student', 'pwd', 'senior', 'none'])
        if discount_type == 'none':
            discount_type = None

        try:
            fare = calculate_fare(start_station, end_station, ticket_type, discount_type, train_line)
            print_fare(fare, start_station, end_station)

            total_fare += fare

            start_index = stations.index(start_station)
            end_index = stations.index(end_station)
            stations_passed = abs(end_index - start_index)
            total_stations_passed += stations_passed

            if train_line == 'LRT1':
                distance_traveled = sum(lrt1_distances[min(start_index, end_index):max(start_index, end_index)])
            elif train_line == 'LRT2':
                distance_traveled = sum(lrt2_distances[min(start_index, end_index):max(start_index, end_index)])
            elif train_line == 'MRT3':
                distance_traveled = sum(mrt3_distances[min(start_index, end_index):max(start_index, end_index)])
            total_distance += distance_traveled

            previous_end_station = end_station

        except ValueError as e:
            print(f"An error occurred: {e}")

        print(" " * 22 + f"You are currently at {previous_end_station}")
        print("\n" + "=" * 80)

        if previous_end_station in ["Recto", "Doroteo Jose", "Taft Ave", "EDSA", "Cubao", "Cubao Araneta"]:
            switch_line = input("Do you want to switch lines? (yes/no): ").strip().lower()

            while switch_line not in ['yes', 'no']:
                switch_line = input("Invalid choice. Do you want to switch lines? (yes/no): ").strip().lower()

            if switch_line == 'yes':
                if train_line == 'LRT1':
                    if previous_end_station == "Doroteo Jose":
                        train_line = 'LRT2'
                        previous_end_station = "Recto"
                        print("\n" + "=" * 80)
                        print(" " * 26 + "You are currently at Recto")
                        print("=" * 80)

                    elif previous_end_station == "EDSA":
                        train_line = 'MRT3'
                        previous_end_station = "Taft Ave"
                        print("\n" + "=" * 80)
                        print(" " * 26 + "You are currently at Taft Ave")
                        print("=" * 80)

                elif train_line == 'LRT2':
                    if previous_end_station == "Recto":
                        train_line = 'LRT1'
                        previous_end_station = "Doroteo Jose"
                        print("\n" + "=" * 80)
                        print(" " * 22 + "You are currently at Doroteo Jose")
                        print("=" * 80)

                    elif previous_end_station == "Cubao":
                        train_line = 'MRT3'
                        previous_end_station = "Cubao Araneta"
                        print("\n" + "=" * 80)
                        print(" " * 22 + "You are currently at Cubao Araneta")
                        print("=" * 80)

                elif train_line == 'MRT3':
                    if previous_end_station == "Taft Ave":
                        train_line = 'LRT1'
                        previous_end_station = "EDSA"
                        print("\n" + "=" * 80)
                        print(" " * 27 + "You are currently at EDSA")
                        print("=" * 80)

                    elif previous_end_station == "Cubao Araneta":
                        train_line = 'LRT2'
                        previous_end_station = "Cubao"
                        print("\n" + "=" * 80)
                        print(" " * 27 + "You are currently at Cubao")
                        print("=" * 80)

                if train_line == 'LRT1':
                    lrt1_print_intro()
                    lrt1_print_stations()
                    normalized_stations = normalized_lrt1_stations
                    stations = lrt1_stations
                elif train_line == 'LRT2':
                    lrt2_print_intro()
                    lrt2_print_stations()
                    normalized_stations = normalized_lrt2_stations
                    stations = lrt2_stations
                elif train_line == 'MRT3':
                    mrt3_print_intro()
                    mrt3_print_stations()
                    normalized_stations = normalized_mrt3_stations
                    stations = mrt3_stations
                continue

        continue_choice = input("Do you want to ride again? (yes/no): ").rstrip().lower()

        while continue_choice not in ['yes', 'no']:
            print("=" * 80)
            continue_choice = input("\nDo you want to ride again? (yes/no): ").rstrip().lower()

        if continue_choice == 'no':
            print("\n" + "=" * 80)
            print(" " * 20 + "Thank you for using LRT/MRT station!")
            print(" " * 20 + f"Total distance traveled: {total_distance:.2f} km")
            print(" " * 20 + f"Total stations passed: {total_stations_passed} stations")
            print(" " * 20 + f"Total fare for all rides: ₱{total_fare:.2f}")
            print("=" * 80 + "\n")
            break
        else:
            print("\n" + "=" * 80)
            print(f"The fare from {start_station} to {end_station} is: ₱{fare:.2f}")
            print("\n" + "=" * 80)
            print(" " * 22 + f"You are currently at {previous_end_station}")
            print("=" * 80)

            if train_line == 'LRT1':
                lrt1_print_stations()
            elif train_line == 'LRT2':
                lrt2_print_stations()
            else:
                mrt3_print_stations()

if __name__ == "__main__":
    main()